{% extends "grades/base.html" %}

{% block title %}{{ activity.name }} Information{% endblock %}
{% block h1 %}{{ activity.name }} Information{% endblock %}

{% block grades_headextra %}
<script type="text/javascript">
    $(document).ready(function() {
	addLinkClickStyleClass('a.redbutton', 'redbutton_onclick');
	// activate dataTable ui
	oTable = $('#student_grades').dataTable({
		"bJQueryUI": true,
		"sPaginationType": "full_numbers",
		"iDisplayLength" : 50,
		"aoColumns": [
		    { "sType": "html" },
		    null,
		    null,
		    null,
		    {% if not activity.calnumericactivity %}
		    { "sWidth": "3em" }
		    {% endif %}
		]
	});
    });
</script>
{% endblock %}

{% block subbreadcrumbs %}<li>&gt; <a href="{{course.get_absolute_url}}">{{ course.name }}</a></li><li>&gt; {{ activity.name }}</li>{% endblock %}

{% block actions %}
<div id="actions">
<h2>Actions</h2>
<ul>
<li><a href="{% url grades.views.edit_activity course_slug=course.slug activity_slug=activity.slug %}?from_page={{ from_page }}">Edit Activity Details</a></li>
<li><a href="{% url submission.views.show_components course_slug=course.slug, activity_slug=activity.slug%}">Configure Submission</a></li>
<li><a href="{% url marking.views.manage_activity_components course_slug=course.slug,activity_slug=activity.slug%}">Configure Marking</a></li>
<li><a href="{% url marking.views.manage_common_problems course_slug=course.slug,activity_slug=activity.slug%}">Configure Common Problems</a></li>
<li><a href="{% url marking.views.mark_all_students course_slug=course.slug, activity_slug=activity.slug%}">Mark all</a></li>
<li><a href="{% url marking.views.export_csv course_slug=course.slug, activity_slug=activity.slug%}">Export all</a></li> 
</ul>
</div>
{% endblock %}

{% block content %}

<div class="table_container">
    <table class="info">
        <tbody>
	    <tr>
                <th class="ui-state-default">Activity Type</th>
                <td>{{ activity_type }}</td>
            </tr>
            <tr>
                <th class="ui-state-default">Name</th>
                <td>
                    {{activity.name}}
                </td>
            </tr>
            <tr>
                <th class="ui-state-default">Short name</th>
                <td>{{activity.short_name}}</td>
            </tr>
            <tr>
                <th class="ui-state-default">Status</th>
                <td>{{activity.get_status_display}}</td>
            </tr>
            <tr>
                <th class="ui-state-default">Due date</th>
                <td>{{activity.due_date}}</td>
            </tr>
            <tr>
                <th class="ui-state-default">Percentage</th>
                <td>{{activity.percent}}</td>
            </tr>
            {% if activity.numericactivity %}
            <tr>
                <th class="ui-state-default">Maximum grade</th>
                <td>{{activity.max_grade}}</td>
            </tr>
            {% endif %}
	    {% if activity.calnumericactivity %}
            <tr>
                <th class="ui-state-default">Formula</th>
                <td>{{activity.formula}}</td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

{% block activity_info_grades_block %}
{% if activity.group %}
<a class="button" href="{% url grades.views.activity_info_with_groups course_slug=course.slug, activity_slug=activity.slug%}">View By Group</a>
{% endif %}
{% if activity.calnumericactivity %}
<div class="buttongroup">
    <a class="redbutton" href="{% url grades.views.calculate_all course_slug=course.slug activity_slug=activity.slug %}">Calculate all</a>
</div>
{% endif %}
<div class="datatable_container">
    <table class="display" id="student_grades">
        <thead>
            <tr>
                <th>Student Name</th>
		<th>Student Number</th>
		<th>Grade Status</th>
		<th>Grade</th>
		{% if not activity.calnumericactivity %}
		<th><img src="{{MEDIA_URL}}icons/disk_multiple.png" title="Submission" alt="Submission" /></th>
		{% endif %}
            </tr>
	</thead>
        <tbody>
	    {% for student_grade_info in student_grade_info_list %}
	    <t>
		<td scope="row">
		    <a href="{% url grades.views.activity_info_student course_slug=course.slug activity_slug=activity.slug userid=student_grade_info.userid%}">{{ student_grade_info.name }}</a>
		</td>
		<td>{{ student_grade_info.emplid }}</td>
		<td>{{ student_grade_info.grade_status }}</td>
		<td>
		{% if activity.calnumericactivity %}
		    {{ student_grade_info.display_grade_staff }}
		{% else %}
		    {% ifequal student_grade_info.grade_status 'no grade'%} 
			<a href="{% url submission.views.take_ownership_and_mark course_slug=course.slug activity_slug=activity.slug userid=student_grade_info.userid %}?from_page={{from_page}}"><img src="{{MEDIA_URL}}icons/page_white_edit.png" title="Mark This" alt="Mark This"/></a>		   
		    {% else %}
			<a href="{% url marking.views.mark_summary_student course_slug=course.slug activity_slug=activity.slug userid=student_grade_info.userid %}"><img src="{{MEDIA_URL}}icons/magnifier.png" title="View Detail" alt="View Detail" /></a>
			{{ student_grade_info.display_grade_staff }}		   
		    {% endifequal %}
		{% endif %}
		</td>
		{% if not activity.calnumericactivity %}
		<td>
		    <a href="{% url submission.views.show_student_submission_staff course_slug=course.slug activity_slug=activity.slug userid=student_grade_info.userid %}"><img src="{{MEDIA_URL}}icons/magnifier.png" title="View" alt="View" /></a>
		    <a href="{% url submission.views.download_file course_slug=course.slug activity_slug=activity.slug userid=student_grade_info.userid %}"><img src="{{MEDIA_URL}}icons/page_compressed.png" title="Download" alt="Download" /></a>
		</td>
		{% endif %}
	    </tr>
	    {% empty %}
	    <tr>
		<td>No student</td>
		<td></td>
		<td></td>
		<td></td>
		{% if not activity.calnumericactivity %}
		<td></td>
		{% endif %}
	    </tr>
	    {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
{% endblock %}
