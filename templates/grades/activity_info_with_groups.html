{% extends "grades/activity_info.html" %}

{% block grades_headextra %}
<script type="text/javascript">
    $(document).ready(function() {
		// activate dataTable ui
		oTable = $('#group_grades').dataTable({
			"bJQueryUI": true,
			"sPaginationType": "full_numbers",
			"iDisplayLength" : 50,
            "aoColumns": [
		    null,
		    null,
            { "sWidth": "3em" }
            ]
		});
		
		{% for info in group_grade_info_list %}		
	    
		    $('#area_{{forloop.counter}}').hide();/* hidden initially */
		    $('#unfold_{{forloop.counter}}').hide();
		    	
		   
		    function cb{{forloop.counter}}(){
		   	$('#unfold_{{forloop.counter}}').hide();
		   	$('#fold_{{forloop.counter}}').show();
	        }
	       
	        function cbb{{forloop.counter}}(){
		   	$('#fold_{{forloop.counter}}').hide();
		   	$('#unfold_{{forloop.counter}}').show();
	        }        
	        	    	    
		    $('#fold_{{forloop.counter}}').click(
		    	function(){	      		      	      	
		    		$('#area_{{forloop.counter}}').slideToggle(100, cbb{{forloop.counter}});
		    });	    
		    
		    $('#unfold_{{forloop.counter}}').click(
		        function(){	      	      	      	
		    		$('#area_{{forloop.counter}}').slideToggle(100, cb{{forloop.counter}});
		    });
	    
       {% endfor%}    
    });
   
</script>
{% endblock %}

{% block activity_info_grades_block %}
<a class="button" href="{% url grades.views.activity_info course_slug=course.slug, activity_slug=activity.slug%}">View By Student</a>    
<div class="datatable_container">
    <table class="display" id="group_grades">
        <thead>
           <tr>
            <th>Group Name</th>
			<th>Grade</th>
			<th><img src="{{MEDIA_URL}}icons/disk_multiple.png" title="Submission" alt="Submission" /></th>
            </tr>
	    </thead>
        <tbody>
	    {% for group_grade_info in group_grade_info_list %}
	    {% with group_grade_info.group as group %}
		    <tr>
			<td scope="row">				    
		    	<div>
		    	<img id="fold_{{forloop.counter}}" src="{{MEDIA_URL}}icons/fold.png" title="Show members" alt="Show members" />
		    	<img id="unfold_{{forloop.counter}}" src="{{MEDIA_URL}}icons/unfold.png" title="Hide members" alt="Hide members" />
		    	<a href="#">{{ group.name }}</a> 
		    	</div>
		    	<div class="group_info_area" id="area_{{forloop.counter}}">
		    	    <ul class="group_member_list">
			    		{% for group_member in group_grade_info.members %}
			    		<li>
			    		<a href="{% url grades.views.activity_info_student course_slug=course.slug activity_slug=activity.slug userid=group_member.userid%}">{{group_member.name}}</a>			    		
			    		</li>
		    		{% endfor %}
		    		</ul>
		    		<a href="#"><img src="{{MEDIA_URL}}icons/user_add.png" title="Add member" alt="add member" style="float: left;"/></a>		    		
		    	</div>	    	   	   
			</td>
			<td>
			{% ifequal group_grade_info.grade 'no grade'%} 
				<a href="{% url submission.views.take_ownership_and_mark_group course_slug=course.slug activity_slug=activity.slug group_slug=group.slug %}?from_page={{from_page}}"><img src="{{MEDIA_URL}}icons/page_white_edit.png" title="Mark This" alt="Mark This"/></a>
			{% else %}
			    <a href="{% url marking.views.mark_summary_group course_slug=course.slug activity_slug=activity.slug group_slug=group.slug %}"><img src="{{MEDIA_URL}}icons/magnifier.png" title="View Detail" alt="View Detail" /></a>
			    {{ group_grade_info.grade }}		   
			{% endifequal %}	
			</td>
			<td>
			    <a href="{% url submission.views.show_student_submission_staff course_slug=course.slug activity_slug=activity.slug userid=group_grade_info.members.0.userid %}"><img src="{{MEDIA_URL}}icons/magnifier.png" title="View" alt="View" /></a>
                <a href="{% url submission.views.download_file course_slug=course.slug activity_slug=activity.slug userid=group_grade_info.members.0.userid %}"><img src="{{MEDIA_URL}}icons/page_compressed.png" title="Download" alt="Download" /></a>
			</td>
			{% endwith %}
		    </tr>
	    {% empty %}
	    <tr>
		<td>No group</td>
		<td></td>
		<td></td>
	    </tr>
	    {% endfor %}
        </tbody>
    </table>
</div>
<h2>
There are still {{ungrouped_students}} students left who is in no group!
<h2>
{% endblock %}