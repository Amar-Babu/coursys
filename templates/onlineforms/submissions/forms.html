{% extends "base.html" %}
{% load form_display %}
{% block h1 %} Forms {% endblock %}
{% block title %} Forms {% endblock %}

{% block subbreadcrumbs %}
<li>&gt; Forms</li>
{% endblock %}

{% block headextra %}
<script type="text/javascript">
    $(document).ready(function() {
        $('#form_table').dataTable({
                    "bPaginate": false,
                    "bJQueryUI": true,
                    "aaSorting": [[0, "asc"]],
        });
        $('#sheet_table').dataTable({
                        "bPaginate": false,
                        "bJQueryUI": true,
                        "aaSorting": [[0, "asc"]],
        }); 
    });
</script>
{% endblock %}

{% block actions %}
{% if form_groups or dept_admin %}
<div id="actions">
    <h2 class="heading">Actions</h2>
    <ul>
    	{% if form_groups %}
        <li><a href="{% url onlineforms.views.list_all %}">Create/Edit Forms</a></li>
        <li><a href="{% url onlineforms.views.admin_list_all %}">Manage Submissions</a></li>
        {% endif %}
    	{% if dept_admin %}
        <li><a href="{% url onlineforms.views.manage_groups %}">Manage Form Groups</a></li>
        {% endif %}
    </ul>
</div>
{% endif %}
{% endblock %}

{% block content %}
<h2>Available forms</h2>
 	<p>These forms can be filled out and submitted online:</p>
    {% if forms %}
        <ul>
            {% for form in forms %}
            <li><a href="{% url onlineforms.views.sheet_submission_initial form_slug=form.slug %}">{{ form.title }}</a> ({{ form.unit.name }}) <span class="helptext">{{ form.description }}</span></li>
            {% endfor %}
        </ul>
    {% else %}
            <p class="empty">There are currently no forms.</p>
    {% endif %}

{% if sheet_submissions %}
<h2>Assigned Forms</h2>
<div class="datatable_container">
    <table class="display" id="sheet_table">
        <thead>
            <tr>
                <th scope="col">Title</th>
                <th scope="col">Form</th>
            </tr>
        </thead>
        {% for sheet_sub in sheet_submissions %}
            <tr>
                <td><a href="{% url onlineforms.views.sheet_submission_subsequent form_slug=sheet_sub.form_submission.form.slug formsubmit_slug=sheet_sub.form_submission.slug sheet_slug=sheet_sub.sheet.slug sheetsubmit_slug=sheet_sub.slug %}">{{ sheet_sub.sheet.title }}</a></td>
                <td>{{ sheet_sub.form_submission.form.title }}</td>
            </tr>
        {% endfor %}
    </table>
</div>
{% endif %}
{% endblock %}