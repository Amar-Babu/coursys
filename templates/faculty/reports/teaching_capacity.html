{% extends "base.html" %}
{% load event_display %}
{% load form_display %}

{% block title %}Teaching Capacity by Unit{% if semester %}: {{ semester }}{% endif %}{% endblock %}
{% block h1 %}Teaching Capacity by Unit{% if semester %}: {{ semester }}{% endif %}{% endblock %}

{% block headextra %}
<script type="text/javascript">
$(document).ready(function() {
  $('table').dataTable({
      bPaginate: false,
      bInfo: false,
      aaSorting: [[0, 'asc']],
      bJQueryUI: true
  });
} );
</script>
{% endblock %}

{% block actions %}
<div id="actions">
  <h2>Actions</h2>
  <ul class="fa-ul">
    {% if form.is_valid %}
    <li>
      <a href="{% url 'faculty.views.teaching_capacity_csv' %}?{{ request.GET.urlencode }}">
        <i class="fa fa-li fa-download"></i> Download CSV
      </a>
    </li>
    {% endif %}
  </ul>
</div>
{% endblock %}

{% block subbreadcrumbs %}
<li><a href="{% url "faculty.views.index" %}">Faculty</a></li>
<li>Teaching Capacity by Unit</li>
{% endblock %}

{% block content %}
<form action="" method="GET" class="noprint">
  {{ form|as_dl }}
  <input class="submit" type="submit" value="Select" />
  <input class="submit" type="reset" value="Clear" />
</form>

<table>
  <thead><tr>
    <th scope="col">Unit</th>
    <th scope="col">Person</th>
    <th scope="col">Teaching Credits</th>
    <th scope="col">Expected Teaching Load</th>
    <th scope="col">Available Capacity</th>
  </tr></thead>
  <tbody>
  {% for unit, summaries in units %}
    {% for person, credits, load_decrease, capacity in summaries %}
      <tr>
        <td>{{ unit.label }}</td>
        <td>
          <a href="{% url 'faculty.views.teaching_summary' person.userid_or_emplid %}?start_semester={{ semester.name }}&end_semester={{ semester.name }}">
            {{ person }}
          </a>
        </td>
        <td>{{ credits|fraction_display }}</td>
        <td>{{ load_decrease|fraction_display }}</td>
        <td>{{ capacity|fraction_display }}</td>
      </tr>
    {% endfor %}
  {% endfor %}
  </tbody>
</table>
{% endblock %}
