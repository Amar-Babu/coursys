{% extends "marking/base.html" %}
{% load course_display %}

{% block marking_header_extra %}
<script type="text/javascript">
//<![CDATA[
    function add_more() {
	    var table = document.getElementById('activity_components').childNodes;
	    for (var x = 0; x < table.length; x++) {
	        if (table[x].nodeName == 'TBODY') {
	            var len = table[x].childNodes.length;
	            for (var i = 0; i < 5; i++) {
	                $(table[x].childNodes[len-items_to_add+i]).removeClass('hidden');
	            }
	            items_to_add -= 5;
	            break;
	        }
	    }
	    if (items_to_add == 0) {
	        $("#button_five_more").addClass("hidden");
	    }
	    return false;
	}
    var items_to_add = 25;
    $(document).ready(function() {
	var oTable = $('#activity_components').dataTable({
		"bJQueryUI": true,
		"bSort": false,
		"bFilter": false,
		"bPaginate": false/* turn off the pagination */,
		"oLanguage": {
			"sInfo": "",
			"sInfoEmpty": "Showing 0 to 0 of 0 records"
		}
	});
	$("#button_five_more").removeClass("hidden");
	$("#button_five_more").click(add_more);
	add_more();
    });
//]]>
</script>
{% endblock %}

{% block title %}{{activity.name}} Marking Components{% endblock %}
{% block h1 %}{{activity.name}} Marking Components{% endblock %}

{% block marking_subbreadcrumbs %}<li>&gt; <a href="{{ activity.get_absolute_url }}">{{activity.name}}</a></li><li>&gt; Marking Components</li>{% endblock %}
{% block content %}
<ul id="form_nav">
    <li class="current"><a href="{% url marking.views.manage_activity_components course_slug=course.slug activity_slug=activity.slug %}">Edit Components Content</a></li>  
    <li><a href="{% url marking.views.manage_component_positions course_slug=course.slug activity_slug=activity.slug %}">Edit Components Order</a></li>  
</ul>
<form action="" method="post">{% csrf_token %}
     <div class="datatable_container"> 
     {{ formset.management_form }} 
      <table class="display" id="activity_components">
      	<thead class="form_head">
          <tr>
         	<th scope="col">Title</th>
         	<th scope="col">Description</th>
         	<th scope="col">Max Mark</th>
         	<th scope="col">Delete?</th>            
          </tr>         
        </thead>  
        <tbody>
	      {% for form in formset.forms|slice:":-25" %} 	      
		      {{ form|display_form_as_row:"deleted_flag"}}
	      {% endfor %}
	      {# you can add 25 more components #}
          {% for form in formset.forms|slice:"-25:" %}
              {{ form|display_form_as_row:"hidden" }}
          {% endfor %}
        </tbody>
      </table>
   </div>
<p><input class ="submit" type="submit" value="Submit" /></p>
<p><input class="submit hidden" type="submit" value="Add 5 more" id="button_five_more" /></p>   
</form>  
{% endblock %}
